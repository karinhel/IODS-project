title(ylab="Lopputulos", col.lab=rgb(0,0.5,0))
box()
############################################################################################
qplot(Muuthaku$v5, Muuthaku$v7_u)
y <- c(v5=1, v5=2, v5=3, v5=4)
x <- c(1, 2, 3, 4)
plot(x, keskarvo, type="o", col="blue", ann=F, axes=FALSE)
par(mar=c(5,4,4,8)+0.1)
axis(2, at=1:2, lab=c("hyväksytty", "hylätty"))
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
title(xlab="Hakemuksen kohteena ollut ratkaisu", col.lab=rgb(0,0.5,0))
title(ylab="Lopputulos", col.lab=rgb(0,0.5,0))
box()
qplot(Muuthaku$v5, Muuthaku$v7_u)
y <- c(v5=1, v5=2, v5=3, v5=4)
x <- c(1, 2, 3, 4)
plot(x, keskarvo, type="o", col="blue", ann=F, axes=FALSE)
axis(2, at=1:2, lab=c("hyväksytty", "hylätty"))
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
title(xlab="Hakemuksen kohteena ollut ratkaisu", col.lab=rgb(0,0.5,0))
title(ylab="Lopputulos", col.lab=rgb(0,0.5,0))
box()
mtext("Hyväksytty", Side=4, Line=3, cex.lab=1, las=2,)
mtext("Hyväksytty", Side=2, Line=3, cex.lab=1, las=2,)
mtext("Hyväksytty", Side=2, Line=3, cex.lab=1, las=2,)
mtext("Hyväksytty", Side=2, Line=4, cex.lab=1, las=2,)
mtext("Hyväksytty", Side=2, Line=4, cex.lab=1, las=2,)
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
mtext("Hyväksytty", Side=2, Line=4, cex.lab=1, las=2,)
mtext("Hyväksytty", Side=2, Line=4, cex.lab=1, las=2)
mtext("Hyväksytty", Side=4, Line=3)
mtext("Hyväksytty", Side=4, Line=2)
mtext("Hyväksytty", Side=4, Line=2)
plot(x, keskarvo, type="o", col="blue", ann=F, axes=FALSE)
axis(2, at=1:2, lab=c("hyväksytty", "hylätty"))
mtext("Hyväksytty", Side=4, Line=2)
mtext("Hyväksytty", Side=3, Line=2)
mtext("Hyväksytty", Side=1, Line=2)
plot(x, keskarvo, type="o", col="blue", ann=F, axes=FALSE)
axis(2, at=1:2, lab=c("hyväksytty", "hylätty"))
mtext("Hyväksytty", Side=1, Line=2)
scale_size_area()
plot(x, keskarvo, type="o", col="blue", ann=F, axes=FALSE)
axis(2, at=1:2, lab=c("hyväksytty", "hylätty"))
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
scale_size_area()
scale_size_area(0.5)
scale_size_area(1)
title(xlab="Hakemuksen kohteena ollut ratkaisu", col.lab=rgb(0,0.5,0))
title(ylab="Lopputulos", col.lab=rgb(0,0.5,0))
box()
plot(x, keskarvo, type="o", col="blue", ann=F, axes=T)
axis(2, at=1:2, lab=c("hyväksytty", "hylätty"))
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
title(xlab="Hakemuksen kohteena ollut ratkaisu", col.lab=rgb(0,0.5,0))
title(ylab="Lopputulos", col.lab=rgb(0,0.5,0))
plot(x, keskarvo, type="o", col="blue", ann=F, axes=F)
axis(2, at=1:2, lab=c("hyväksytty", "hylätty"))
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
axis(2, at=0:1, lab=c("hyväksytty", "hylätty"))
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
title(xlab="Hakemuksen kohteena ollut ratkaisu", col.lab=rgb(0,0.5,0))
title(ylab="Lopputulos", col.lab=rgb(0,0.5,0))
p + scale_y_discrete(name= "Lopputulos", limits=c("Hyväksytty","Hylätty"))
default plot
scale_y_discrete(name= "Lopputulos", limits=c("Hyväksytty","Hylätty"))
+ scale_y_discrete(name= "Lopputulos", limits=c("Hyväksytty","Hylätty"))
title(ylab="Lopputulos", limits=c("Hyväksytty","Hylätty") col.lab=rgb(0,0.5,0))
box()
title(ylab="Lopputulos", limits=c("Hyväksytty","Hylätty") col.lab=rgb(0,0.5,0))
title(ylab="Lopputulos", limits=c("Hyväksytty","Hylätty"), col.lab=rgb(0,0.5,0))
title(ylab="Lopputulos", col.lab=rgb(0,0.5,0))
plot(x, keskarvo, type="o", col="blue", ann=F, axes=F)
+ scale_y_discrete(name= "Lopputulos", limits=c("Hyväksytty","Hylätty"))
axis(2, at=0:1, lab=c("hyväksytty", "hylätty"))
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
scale_y_discrete(name= "Lopputulos", limits=c("Hyväksytty","Hylätty"))
plot(x, keskarvo, type="o", col="blue", ann=F, axes=F)
p + scale_y_discrete(name= "Lopputulos", limits=c("Hyväksytty","Hylätty"))
plot + scale_y_discrete(name= "Lopputulos", limits=c("Hyväksytty","Hylätty"))
p + scale_y_discrete(name= "Lopputulos", limits=c("Hyväksytty","Hylätty"))
SoilSciGuyLabs <- c("Hyväksytty", "Hylätty")
+ scale_y_discrete(labels = SoilSciGuyLabs)
+ scale_x_discrete(labels = SoilSciGuyLabs)
+ scale_x_discrete(labels= SoilSciGuyLabs)
axis(2, at=0:1, lab=c("hyväksytty", "hylätty"))
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
axis(2, at=0:1, lab=c("hyväksytty", "hylätty"))
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
scale_y_discrete(name= "Lopputulos", limits=c("Hyväksytty","Hylätty"))
limits("HYäksytty")
labels?
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
model <- glm (Recommended ~ .-ID, data = Muuthaku, family = binomial)
summary(model)
install.packages('caTools')
library(caTools)
install.packages(caTools)
install.packages('caTools')
install.packages("caTools")
library(caTools)
model <- glm (Recommended ~ .-ID, data = Muuthaku, family = binomial)
View(Muuthaku)
Muuthaku = read.spss("C:\\Users\\Karin\\Documents\\opiskelulv16-17\\KANDI\\Asenteet.sav", to.data.frame=TRUE)
library(foreign)
Muuthaku = read.spss("C:\\Users\\Karin\\Documents\\opiskelulv16-17\\KANDI\\Asenteet.sav", to.data.frame=TRUE)
View(Muuthaku)
library(caTools)
str(bv9)
str(Muuthaku$bv9)
summary(Muuthaku$bv9)
+ family = binomial())
+ family = binomial() )
family = binomial() )
family = binomial()
malliglm <- glm(v7 ~ bv9, data = Muuthaku, family = binomial())
summary(malliglm)
plot(malliglm)
return
return
plot(bv9,v7)
plot(bv9,v7, data=Muuthaku)
plot(data=Muuthaku, bv9,v7)
plot(, Muuthaku$bv9,Muuthaku$v7)
plot(Muuthaku$bv9,Muuthaku$v7)
summary(v7)
summary(Muuthaku$v7)
summary(Muuthaku$v7_u)
qplot(Muuthaku$bv9,Muuthaku$v7)
library(ggplot2)
qplot(Muuthaku$bv9,Muuthaku$v7)
qplot(malliglm)
malliglm2 <- glm(bv9 ~ v7, data=Muuthaku, family = binomial())
summary(malliglm2)
tulos <- c(0,1)
tulos
tulos <- [Muuthaku$v7_u - 1]
tulos <- Muuthaku$v7_u - 1
tulos
malliglm2 <- glm(tulos ~ bv9, data = Muuthaku, family = binomial())
plot(bv9, tulos)
plot(Muuthaku$bv9, tulos)
summary(malliglm2)
qplot(Muuthaku$bv9, tulos)
install.packages('pROC')
library(pROC)
qplot(Muuthaku$bv9, tulos, colour=color)
qplot(Muuthaku$bv9, tulos, colour=blue)
qplot(Muuthaku$bv9, tulos, color=blue)
qplot(Muuthaku$bv9, tulos, shape=cut)
qplot(Muuthaku$bv9, tulos, colour=color)
plot(malliglm2)
return
summary(malliglm2)
library(Data1)
file.choose()
file.choose()
data = file.choose()
file.choose()
Data1 = read("C:\\Users\\Karin\\Documents\\opiskelulv16-17\\Ekonometria\\Data1", to.data.frame=T)
qplot(Muuthaku$bv9, tulos, col=bv9) #<- miten??
qplot(Muuthaku$bv9, tulos, col=Muuthaku$bv9) #<- miten??
ggplot(Muuthaku$bv9, tulos, col=Muuthaku$bv9) #<- miten??
qplot(Muuthaku$bv9, tulos, col=Muuthaku$bv9) #<- miten??
3.01e-16 < 0.001
Data1 = read.table("C:\\Users\\Karin\\Documents\\opiskelulv16-17\\Ekonometria\\Data1", to.data.frame=T)
Data1 = read.table("C:\\Users\\Karin\\Documents\\opiskelulv16-17\\Ekonometria\\Data1")
install.package(GGally)
library(foreign)
install.package(GGally)
library(GGally)
tulos <- Muuthaku$v7_u - 1
malliglm2 <- glm(tulos ~ v5, data = Muuthaku, family = binomial())
malliglm3 <- glm(tulos ~ v5, data = Muuthaku, family = binomial())
malliglm2 <- glm(tulos ~ bv9, data = Muuthaku, family = binomial())
summary(malliglm3)
ggplot(Muuthaku, aes(v5, tulos, col=v5))
ggplot(Muuthaku, aes(v5, tulos))
str(v5)
str(Muuthaku$v5)
summary(Muuthaku$v5)
qplot(v5, tulos)
qplot(Muuthaku$v5, tulos)
qplot(Muuthaku$v5, tulos)+theme_bw()
qplot(Muuthaku$v5, tulos)+theme_bw()+scale_fill_gradient(low="red", high="yellow")
ggplot(data=Muuthaku, aes(x=v5, y=tulos)) + theme_bw()+scale_fill_gradient(low="red", high="yellow")
ggplot(data=Muuthaku, aes(x=v5, y=tulos), geom="point") + theme_bw()+scale_fill_gradient(low="red", high="yellow")
ggplot(data=Muuthaku, aes(x=v5, y=tulos), geom="point") + theme_bw()+scale_fill_gradient(low="red", high="yellow")
ggplot(data=Muuthaku, aes(x=v5, y=v7), geom="point") + theme_bw()+scale_fill_gradient(low="red", high="yellow")
ggplot(data=Muuthaku, aes(x=v5, y=tulos), geom="point") + theme_bw()+scale_fill_gradient(low="red", high="yellow")
ggplot(data=Muuthaku, aes(x=v5, y=tulos), geom="point") + theme_bw()+scale_fill_gradient(low="red", high="yellow")+geom_count()
ggplot(data=Muuthaku, aes(x=v5, y=tulos)) + theme_bw()+scale_fill_gradient(low="red", high="yellow")+geom_count()
ggplot(data=Muuthaku, aes(v5, tulos)) + theme_bw()+scale_fill_gradient(low="red", high="yellow")+geom_count()
ggplot(Muuthaku, aes(v5, tulos)) + theme_bw()+scale_fill_gradient(low="red", high="yellow")+geom_count()
ggplot(Muuthaku, aes(v5, tulos)) + theme_bw() + geom_count()
ggplot(Muuthaku, aes(v5, tulos)) + theme_classic() + geom_count()
ggplot(Muuthaku, aes(v5, tulos)) + theme_minimal() + geom_count()
testi1 <- ggplot(Muuthaku, aes(v5, tulos)) + theme_minimal() + geom_count()
testi1 <- ggplot(Muuthaku, aes(v5, tulos)) + theme_minimal() + geom_count(col=blue)
ggplot(Muuthaku, aes(v5, tulos)) + theme_minimal() + geom_count(colour="blue")
ggplot(Muuthaku, aes(v5, tulos)) + theme_minimal() + geom_count(colour="red")
ggplot(Muuthaku, aes(v5, tulos)) + theme_minimal() + geom_count(colour="orange")
ggplot(Muuthaku, aes(v5, tulos)) + theme_minimal() + geom_count(colour="lightblue")
ggplot(Muuthaku, aes(v5, tulos)) + theme_minimal() + geom_count(colour="blue")
t <- ggplot(Muuthaku, aes(v5, tulos)) + theme_minimal() + geom_count(colour="blue")
t + labs(x="Ratkaisun lopputulos", y="Muutoksenhaun kohde")
t + labs(x="Muutoksenhaun kohde", y="Ratkaisun lopputulos")
testi1 <- ggplot(Muuthaku, aes(v5, tulos)) + filter=mean(v5) + theme_minimal() + geom_count(colour="blue")
testi1 <- ggplot(Muuthaku, aes(v5, tulos)) + filter=mean(Muuthaku$v5) + theme_minimal() + geom_count(colour="blue")
p <- plot(x, keskarvo, type="o", col="blue", ann=F, axes=F)
keskarvo <- mean(Muuthaku$v5)
keskarvo <- mean(tulos)
str(keskarvo)
summary(keskarvo)
head(keskarvo)
tulos
attach(Muuthaku)
mytable <- table(v5, tulos)
mytable
prop.table(mytable, 1)
hyv <- c(0.10416667, 0.43678161, 0.82758621, 0.93333333)
hyv
names(hyv) <- c("Rang.määr.", "AO:n tuomio", "HO:n tuomio", "KKO:n tuomio")
hyv
testi1 <- ggplot(Muuthaku, aes(v5, hyv))
testi1 + geom_dotplot()
testi1 <- ggplot(Muuthaku, aes(v5, hyv))
testi1 + geom_dotplot()
testi1 <- ggplot(Muuthaku, aes(hyv, tulos))
testi1 + geom_dotplot()
testi1 <- ggplot(aes(hyv, tulos))
testi1 + geom_dotplot()
plot(hyv)
qplot(hyv)
plot(hyv)
ggplot(hyv, aes(hyv))
ggplot(hyv, aes(hyv)) + geom_dotplot()
ggplot(aes(hyv)) + geom_dotplot()
axis(2, at=0:1, c(0, 0.2, 0.4, 0.8, 1))
axis(2, las=1 at=0:1:c(0, 0.2, 0.4, 0.8, 1))
axis(2, at=0:1:c(0, 0.2, 0.4, 0.8, 1))
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
plot(hyv, col="blue", ann=F, axes=F)
plot(hyv, col="blue", ann=T, axes=F)
plot(hyv, col="blue", ann=F, axes=F)
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
title(xlab="Hakemuksen kohteena ollut ratkaisu", col.lab=rgb(0,0.5,0))
title(ylab="Hväksyttyjen hakemusten keskiarvo", col.lab=rgb(0,0.5,0))
axis(2, at=0:1)
box()
10/4
axis(2, at=0:1, lab=c(0, 0.3, 0.6, 1))
title(xlab="Hakemuksen kohteena ollut ratkaisu")
title(ylab="Hväksyttyjen hakemusten keskiarvo")
p <- function(hyv)
p
p
plot(p)
plot(hyv, col="blue)
plot(hyv, col="blue)
plot(hyv, col="blue")
plot(hyv, col="blue", ylim=c(0,1))
title(cex.lab=0.75)
title(xlab("Muutoksenhaun kohde"), ylab("Ratkaisun lopputulos") cex.lab=0.75)
title(xlab="Muutoksenhaun kohde", ylab="Ratkaisun lopputulos", cex.lab=0.75)
plot(hyv, col="blue", ylim=c(0,1), xlab="Muutoksenhaun kohde", ylab="Ratkaisun lopputulos")
title(cex.lab=0.75)
plot(hyv, col="blue", ylim=c(0,1), xlab="Muutoksenhaun kohde", ylab="Ratkaisun lopputulos", cex.lab=0.75)
plot(hyv, col="blue", ylim=c(0,1), xlab="Muutoksenhaun kohde", ylab="Hyväksyttyjen osuus",
cex.lab=0.75)
plot(hyv, col="blue", ylim=c(0,1), xlab="Muutoksenhaun kohde", ylab="Hyväksyttyjen osuus",
cex.lab=0.75)
plot(hyv, col="blue", ylim=c(0,1), xlab="Muutoksenhaun kohde", ylab="Hyväksyttyjen  hakemusten osuus",
cex.lab=0.75)
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio")))
plot(hyv, col="blue", ylim=c(0,1), xlab="Muutoksenhaun kohde", ylab="Hyväksyttyjen  hakemusten osuus",
cex.lab=0.75,
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio")) )
plot(hyv, col="blue", ylim=c(0,1), xlab="Muutoksenhaun kohde", ylab="Hyväksyttyjen  hakemusten osuus",
cex.lab=0.75)
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
plot(hyv, col="blue", ylim=c(0,1), xlab="Muutoksenhaun kohde", ylab="Hyväksyttyjen  hakemusten osuus",
cex.lab=0.75, xaxt="n")
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
plot(hyv, col="blue", ylim=c(0,1), xlab="Muutoksenhaun kohde", ylab="Hyväksyttyjen  hakemusten osuus",
cex.lab=0.75, type="o", xaxt="n")
axis(1, at=1:4, lab=c("Rangaistusmääräys","AO:n tuomio","HO:n tuomio","KKO:n tuomio"))
Muuthaku = read.spss("C:\\Users\\Karin\\Documents\\opiskelulv16-17\\KANDI\\Asenteet.sav", to.data.frame=TRUE)
library(foreign)
Muuthaku = read.spss("C:\\Users\\Karin\\Documents\\opiskelulv16-17\\KANDI\\Asenteet.sav", to.data.frame=TRUE)
library(ggplot2)
install.packages("GGally")
library(GGally)
anova(malliglm2, test="Chisq")
tulos <- Muuthaku$v7_u - 1
tulos
malliglm2 <- glm(tulos ~ bv9, data = Muuthaku, family = binomial())
anova(malliglm2, test="Chisq")
library(pROC)
prf <- performance(malliglm2, measure = "tpr", x.measure = "fpr")
install.packages('ROCR')
library(ROCR)
prf <- performance(malliglm2, measure = "tpr", x.measure = "fpr")
alc <- read.table(file= "http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/alc.txt ", header=T, sep=",")
colnames(alc)
library(tidyr);library(dplyr);library(ggplot2)
str(alc_use)
str(alc$alc_use)
summary(alc$alc_use)
plot(Log)
Log <- glm(high_use ~ goout + famrel + studytime + sex, data = alc, family = "binomial")
summary(Log)
plot(Log)
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)   }
loss_func(class = alc$high_use, prob = alc$probability)
probabilities <- predict(Log, type = "response")
alc <- mutate(alc, probability = probabilities)
table(high_use = alc$high_use, prediction = alc$prediction) %>% prop.table %>% addmargins
table(high_use = alc$high_use, prediction = alc$prediction) %>% prop.table %>% addmargins
probabilities <- predict(Log, type = "response")
loss_func(class = alc$high_use, prob = alc$probabilities)
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probabilities > 0.5)
table(high_use = alc$high_use, prediction = alc$prediction) %>% prop.table %>% addmargins
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)   }
loss_func(class = alc$high_use, prob = alc$probabilities)
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probabilities)
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probabilities)
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probabilities)
library(tidyr);library(dplyr);library(ggplot2)
Log <- glm(high_use ~ goout + famrel + studytime + sex, data = alc, family = "binomial")
summary(Log)
library(tidyr);library(dplyr);library(ggplot2)
OR <- coef(Log) %>% exp
CI <- confint(Log) %>% exp
OR <- coef(Log) %>% exp
CI <- confint(Log) %>% exp
cbind(OR, CI)
table(high_use = alc$high_use, prediction = alc$prediction) %>% prop.table %>% addmargins
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probabilities)
loss_func(class = alc$high_use, prob = alc$probability)
setwd("~/opiskelulv16-17/IODS-k17/GitHub/IODS-project/Data")
library(MASS)
data("Boston")
str(Boston)
dim(Boston)
pairs(Boston)
summary(Boston)
summary(Boston$age, Boston$crim)
summary(Boston$age)
summary(Boston$crim)
library(tidyr)
boston_scaled <- scale(Boston) %<% boston_scaled <- as.data.frame()
boston_scaled <- as.data.frame(boston_scaled) %>% scale(Boston)
boston_scaled <- as.data.frame(boston_scaled) %>% boston_scaled <- scale(Boston)
boston_scaled <- scale(Boston)
boston_scaled <- as.data.frame(boston_scaled)
library(dplyr)
summary(boston_scaled)
str(Boston)
pairs(Boston)
pairs(Boston, col=darkorchid1)
pairs(Boston, col="darkorchid1")
summary(Boston$crim)
library(ggplot2)
p <- ggplot(Boston, aes(x=crim))
p + geom_point() + col="darkorchid1"
p <- ggplot(Boston, aes(x=crim))+ geom_point() + col="darkorchid1"
p <- ggplot(Boston, aes(x=crim, col="darkorchid1")) + geom_point()
p
p <- ggplot(Boston, aes(x=crim, y=medv, col="darkorchid1")) + geom_point()
p
p <- ggplot(Boston, aes(x=crim, y=medv)) + geom_point() + col="darkorchid1"
p <- ggplot(Boston, aes(x=crim, y=medv)) + geom_point() + col=="darkorchid1"
p <- ggplot(Boston, aes(x=crim, y=medv)) + geom_point()
p
p <- ggplot(Boston, aes(x=medv, y=crim)) + geom_point()
p
p + theme_bw()
p + theme_minimal()
p + theme_classic()
p + theme_bw()
p <- ggplot(Boston, aes(x=medv, y=crim)) + geom_point(col=col="darkorchid1")
p <- ggplot(Boston, aes(x=medv, y=crim)) + geom_point(col="darkorchid1")
p + theme_bw()
summary(Boston$medv)
summary(Boston$crim)
p + theme_bw()
pairs(Boston, col="darkorchid1", header="Pairs plot")
?pairs
pairs(Boston, col="darkorchid1", main="Pairs plot")
pairs(Boston, col="darkorchid1", main="Pairs-plot of the Boston dataset")
p <- ggplot(Boston, aes(x=medv, y=crim)) + geom_point(col="darkorchid1") + ggtitle("Crime rate for median value of owner-occupied homes")
p <- ggplot(Boston, aes(x=medv, y=crim)) + geom_point(col="darkorchid1") + ggtitle("Crime rate at median value of owner-occupied homes")
p + theme_bw()
p <- ggplot(Boston, aes(x=medv, y=crim)) + geom_point(col="darkorchid1") + xlab("Crime rate") + ylab("Median value of owner-occupied homes") + ggtitle(Scatterplot of crime rate)
p <- ggplot(Boston, aes(x=medv, y=crim)) + geom_point(col="darkorchid1") + xlab("Crime rate") + ylab("Median value of owner-occupied homes") + ggtitle("Scatterplot of crime rate")
p + theme_bw()
p <- ggplot(Boston, aes(x=medv, y=crim)) + geom_point(col="darkorchid1") + ylab("Crime rate") + xlab("Median value of owner-occupied homes") + ggtitle("Scatterplot of crime rate")
p + theme_bw()
p <- ggplot(Boston, aes(x=medv, y=crim)) + geom_point(col="darkorchid1") + ylab("Crime rate \capita") + xlab("Median value of owner-occupied homes \$1000s") + ggtitle("Scatterplot of crime rate")
p <- ggplot(Boston, aes(x=medv, y=crim)) + geom_point(col="darkorchid1") + ylab("Crime rate per capita") + xlab("Median value of owner-occupied homes per $1000s") + ggtitle("Scatterplot of crime rate")
p + theme_bw()
pairs(Boston, col="darkorchid1", alpha=0.3, main="Pairs-plot of the Boston dataset")
g <- ggpairs(Boston, col="darkorchid1", alpha=0.3, main="Pairs-plot of the Boston dataset",
mapping = aes(alpha=0.3), lower = list(combo = wrap("facethist", bins = 20)))
library(GGally)
g <- ggpairs(Boston, col="darkorchid1", alpha=0.3, main="Pairs-plot of the Boston dataset",
mapping = aes(alpha=0.3), lower = list(combo = wrap("facethist", bins = 20)))
g <- ggpairs(Boston, col="darkorchid1",
mapping = aes(alpha=0.3), lower = list(combo = wrap("facethist", bins = 20)))
g <- ggpairs(Boston, mapping = aes(col="darkorchid1", alpha=0.3), lower = list(combo = wrap("facethist", bins = 20)))
g
pairs(Boston, col="darkorchid1")
summary(Boston$crim)
p + theme_bw()
scaled_crim <- boston_scaled$crim
bins <- quantile(scaled_crim)
crime <- cut(scaled_crim, breaks = bins, include.lowest = TRUE, labels = c("low", "med_low", "med_high", "high"))
table(crime)
boston_scaled <- dplyr::select(boston_scaled, -crim)
boston_scaled <- data.frame(boston_scaled, crime)
n <- nrow(boston_scaled)
ind <- sample(n,  size = n * 0.8)
train <- boston_scaled[ind,]
test <- boston_scaled[-ind,]
correct_classes <- test$crime
test <- dplyr::select(test, -crime)
lda.fit <- lda(crime ~ ., data = train)
lda.fit <- lda(crime ~ ., data = train)
lda.fit
lda.arrows <- function(x, myscale = 1, arrow_heads = 0.1, color = "red", tex = 0.75, choices = c(1,2)){
heads <- coef(x)
arrows(x0 = 0, y0 = 0,
x1 = myscale * heads[,choices[1]],
y1 = myscale * heads[,choices[2]], col=color, length = arrow_heads)
text(myscale * heads[,choices], labels = row.names(heads),
cex = tex, col=color, pos=3)
}
classes <- as.numeric(train$crime)
plot(lda.fit, dimen = 2, col=classes, pch=classes)
lda.arrows(lda.fit, myscale = 3)
plot(lda.fit, dimen = 2, col=classes, pch=classes)
lda.arrows(lda.fit, myscale = 3)
lda.pred <- predict(lda.fit, newdata = test)
table(correct = correct_classes, predicted = lda.pred$class)
plot(lda.fit, dimen = 2, col=rainbow(4, start = 0.7, end = 0.9)[classes], pch=classes)
plot(lda.fit, dimen = 2, col=rainbow(4, start = 0.7, end = 0.9)[classes], pch=classes)
lda.arrows(lda.fit, myscale = 3)
plot(lda.fit, dimen = 2, col=rainbow(4, start = 0.7, end = 0.9)[classes], pch=classes)
lda.arrows(lda.fit, myscale = 3, col="darkblue")
plot(lda.fit, dimen = 2, col=rainbow(4)[classes], pch=classes)
plot(lda.fit, dimen = 2, col=cm.colors(cyan-magenta)[classes], pch=classes)
plot(lda.fit, dimen = 2, col=cm.colors("cyan-magenta")[classes], pch=classes)
plot(lda.fit, dimen = 2, col=cm.colors[classes], pch=classes)
plot(lda.fit, dimen = 2, col=rainbow(4)[classes], pch=classes)
plot(lda.fit, dimen = 2, col=rainbow(4, start = 0.7, end = 0.9)[classes], pch=classes)
plot(lda.fit, dimen = 2, col=rainbow(4, start = 0.7, end = 0.9)[classes], pch=classes)
plot(lda.fit, dimen = 2, col=rainbow(4, start = 0.7, end = 0.9)[classes], pch=classes)
lda.arrows(lda.fit, myscale = 3, col="darkblue")
data("Boston")
data("Boston")
dim(Boston)
boston_stand <- scale(Boston)
boston_stand <- as.data.frame(boston_scaled)
boston_stand <- as.data.frame(boston_stand)
dist_eu <- dist(boston_stand)
summary(dist_eu)
dist_man <- dist(boston_stand, method="manhattan")
summary(dist_man)
set.seed(123)
k_max <- 10
twcss <- sapply(1:k_max, function(k){kmeans(dist_eu, k)$tot.withinss})
plot(1:k_max, twcss, type='b')
plot(1:k_max, twcss, type='b', col="darkorchid1")
axis(1, at=1:10)
plot(1:k_max, twcss, type='b', col="darkorchid1")
axis(1, at=1:10)
plot(1:k_max, twcss, type='b', col="darkorchid1")
axis(1, at=1:10, ylab="Number of clusters")
plot(1:k_max, twcss, type='b', col="darkorchid1", ylab="Number of clusters")
plot(1:k_max, twcss, type='b', col="darkorchid1", xlab="Number of clusters")
axis(1, at=1:10)
plot(1:k_max, twcss, type='b', col="darkorchid1", xlab="Number of clusters", ylab="Total of within cluster sum of squares")
axis(1, at=1:10)
plot(1:k_max, twcss, type='b', col="darkorchid1", xlab="Number of clusters", ylab="Total WCSS")
axis(1, at=1:10)
km <-kmeans(dist_eu, centers = 2)
km2 <-kmeans(dist_eu, centers = 3)
ggpairs(boston_stand, col=km1$cluster)
km1 <-kmeans(dist_eu, centers = 2)
ggpairs(boston_stand, col=km1$cluster)
